# –ò—Ç–æ–≥–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º

## ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ —Å –ª–æ–≥–∏–∫–æ–π —Ü–≤–µ—Ç–æ–≤
**–§–∞–π–ª:** `equipment_calendar_sync.py`

- üî¥ **–ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç** - –¥–ª—è –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫ (–ø–æ –¥–∞—Ç–∞–º –≤–∑—è—Ç–∏—è –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞)
- üü° **–ñ—ë–ª—Ç—ã–π —Ü–≤–µ—Ç** - –¥–ª—è –∑–∞—è–≤–æ–∫ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏
- ‚ö™ **–ë–µ–ª—ã–π —Ü–≤–µ—Ç** - —Å–≤–æ–±–æ–¥–Ω—ã–µ –¥–∞—Ç—ã
- ‚ùå –û—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
- –ù–æ–º–µ—Ä –∑–∞—è–≤–∫–∏ —Å—Ç–∞–≤–∏—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ –ø–µ—Ä–∏–æ–¥–∞ (–¥–∞—Ç–∞ –≤—ã–¥–∞—á–∏), –∫–æ–Ω—Ü–µ (–¥–∞—Ç–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞) –∏ –¥–∞—Ç–µ —Å—ä—ë–º–∫–∏

**–ú–µ—Ç–æ–¥—ã:**
- `create_or_update_calendar_sheet()` - —Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞ (–æ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã –¥–æ +6 –º–µ—Å—è—Ü–µ–≤)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ batch updates

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
**–§–∞–π–ª:** `equipment_status_sync.py`

**–õ–æ–≥–∏–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤:**
- **–ù–∞ —Å–∫–ª–∞–¥–µ** ‚Üí **–ó–∞–Ω—è—Ç, —Å—ä—ë–º–∫–∞ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç** ‚Üí **–ó–∞–Ω—è—Ç, —Å—ä—ë–º–∫–∞ –æ–∫–æ–Ω—á–µ–Ω–∞** ‚Üí **–ù–∞ —Å–∫–ª–∞–¥–µ**

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
- –°—Ç–∞—Ç—É—Å—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –∏ –¥–∞—Ç –∑–∞—è–≤–æ–∫
- –î–∞—Ç—ã –≤—ã–¥–∞—á–∏ –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–∑ –±–ª–∏–∂–∞–π—à–∏—Ö –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫
- –ü–æ–ª–µ "–£ –∫–æ–≥–æ —Å–µ–π—á–∞—Å?" –∏–∑ –∑–∞—è–≤–æ–∫
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ batch updates –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Google API

**–ú–µ—Ç–æ–¥—ã:**
- `update_equipment_statuses_by_date()` - –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤

### 3. –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
**–§–∞–π–ª:** `equipment_sync_bidirectional.py`

- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞—è–≤–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ –ë–î –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

**–ú–µ—Ç–æ–¥—ã:**
- `sync_from_sheets()` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –≤ –ë–î
- `sync_status_changes()` - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤

### 4. –°–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
**–§–∞–π–ª:** `equipment_reminders.py`

- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ –¥–µ–Ω—å –¥–æ –≤—ã–¥–∞—á–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞–º)
- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ –¥–µ–Ω—å –¥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞–º)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫

**–ú–µ—Ç–æ–¥—ã:**
- `check_and_send_reminders()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- `_send_issue_reminder()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –≤—ã–¥–∞—á–µ
- `_send_return_reminder()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –≤–æ–∑–≤—Ä–∞—Ç–µ

### 5. –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
**–§–∞–π–ª:** `equipment_notifications.py`

- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏ (—Å –ø—Ä–∏—á–∏–Ω–æ–π)
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –∑–∞—è–≤–∫–∏ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏

**–ú–µ—Ç–æ–¥—ã:**
- `send_status_change_notifications()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–æ–≤
- `_send_approval_notification()` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–¥–æ–±—Ä–µ–Ω–∏–∏
- `_send_rejection_notification()` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏
- `_send_pending_notification()` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤–æ–∑–≤—Ä–∞—Ç–µ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ
- `_send_restored_notification()` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏

### 6. –û–±–Ω–æ–≤–ª—ë–Ω EquipmentSheetsSync
**–§–∞–π–ª:** `equipment_sheets_sync.py`

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å —á–µ—Ä–µ–∑ `EquipmentCalendarSync`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏/–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∑–∞—è–≤–æ–∫

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

```
–°—Ç—Ä–æ–∫–∞ 1: –ü–µ—Ä–∏–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–Ø–Ω–≤–∞—Ä—å 2025 - –ò—é–Ω—å 2025")
–°—Ç—Ä–æ–∫–∞ 2: –ß–∏—Å–ª–∞ –¥–Ω–µ–π (01, 02, 03, ...)
–°—Ç—Ä–æ–∫–∞ 3: –î–Ω–∏ –Ω–µ–¥–µ–ª–∏ (–ü–Ω, –í—Ç, –°—Ä, ...)
–°—Ç—Ä–æ–∫–∞ 4: –ü—É—Å—Ç–∞—è
–°—Ç—Ä–æ–∫–∏ 5+: –ù–æ–º–µ—Ä –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è | –î–∞—Ç–∞1 | –î–∞—Ç–∞2 | ...
```

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

```python
from app.services.equipment_calendar_sync import EquipmentCalendarSync
from app.services.google_service import GoogleService

google_service = GoogleService()
calendar_sync = EquipmentCalendarSync(google_service)

# –û–±–Ω–æ–≤–∏—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å
await calendar_sync.create_or_update_calendar_sheet(db)
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤

```python
from app.services.equipment_status_sync import EquipmentStatusSync

status_sync = EquipmentStatusSync(google_service)
result = await status_sync.update_equipment_statuses_by_date(db)
```

### –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

```python
from app.services.equipment_reminders import EquipmentReminders

reminders = EquipmentReminders(google_service)
result = await reminders.check_and_send_reminders(db, bot=bot)
```

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

```python
from app.services.equipment_notifications import EquipmentNotifications

notifications = EquipmentNotifications()
result = await notifications.send_status_change_notifications(
    db,
    status_changes=[...],
    bot=bot
)
```

## ‚öôÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏

1. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è** - –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π** - –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ (–∏–ª–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 9:00)
3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã** - –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç (–∫–∞–∫ –±—ã–ª–æ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ —Ä–∞–Ω–µ–µ)

### –¢—Ä–∏–≥–≥–µ—Ä—ã

- **–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- **–ü—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è + –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **–ü—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ** - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ë–î + –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram –±–æ—Ç–æ–º** - –ø–æ–¥–∫–ª—é—á–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫ –±–æ—Ç—É
2. **–§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏** - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á
3. **API endpoints** - –¥–æ–±–∞–≤–∏—Ç—å endpoints –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ Google API (60 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç)
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è batch updates –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- –§–æ–Ω–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á
- –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
