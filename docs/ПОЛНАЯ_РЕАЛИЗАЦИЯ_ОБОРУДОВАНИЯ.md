# –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º

## –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –∏–∑ BEST Channel Bot, –≤–∫–ª—é—á–∞—é—â–∞—è:

1. ‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ —Å –ª–æ–≥–∏–∫–æ–π —Ü–≤–µ—Ç–æ–≤ (–∫—Ä–∞—Å–Ω—ã–π/–∂—ë–ª—Ç—ã–π)
2. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –ø–æ –¥–∞—Ç–∞–º
3. ‚è≥ –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ ‚Üí –ë–î)
4. ‚è≥ –°–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ –≤—ã–¥–∞—á–µ –∏ –≤–æ–∑–≤—Ä–∞—Ç–µ
5. ‚è≥ –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–æ–≤

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. EquipmentCalendarSync (`equipment_calendar_sync.py`)

–°–µ—Ä–≤–∏—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è.

**–õ–æ–≥–∏–∫–∞ —Ü–≤–µ—Ç–æ–≤:**
- üî¥ **–ö—Ä–∞—Å–Ω—ã–π** - –¥–ª—è –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫ (–ø–æ –¥–∞—Ç–∞–º –≤–∑—è—Ç–∏—è –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞)
- üü° **–ñ—ë–ª—Ç—ã–π** - –¥–ª—è –∑–∞—è–≤–æ–∫ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏
- ‚ö™ **–ë–µ–ª—ã–π** - —Å–≤–æ–±–æ–¥–Ω—ã–µ –¥–∞—Ç—ã
- ‚ùå –û—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ù–æ–º–µ—Ä –∑–∞—è–≤–∫–∏ —Å—Ç–∞–≤–∏—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ –ø–µ—Ä–∏–æ–¥–∞ (–¥–∞—Ç–∞ –≤—ã–¥–∞—á–∏), –∫–æ–Ω—Ü–µ (–¥–∞—Ç–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞) –∏ –¥–∞—Ç–µ —Å—ä—ë–º–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è (–æ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã –¥–æ +6 –º–µ—Å—è—Ü–µ–≤)
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –∏ –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ batch updates

**–ú–µ—Ç–æ–¥—ã:**
- `create_or_update_calendar_sheet()` - —Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- `_update_calendar_headers()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- `_update_calendar_data()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–Ω–æ–º–µ—Ä–∞ –∑–∞—è–≤–æ–∫)
- `_apply_calendar_formatting()` - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Ü–≤–µ—Ç–∞)

### 2. EquipmentStatusSync (`equipment_status_sync.py`)

–°–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –ø–æ –¥–∞—Ç–∞–º.

**–õ–æ–≥–∏–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤:**
- **–ù–∞ —Å–∫–ª–∞–¥–µ** ‚Üí **–ó–∞–Ω—è—Ç, —Å—ä—ë–º–∫–∞ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç** ‚Üí **–ó–∞–Ω—è—Ç, —Å—ä—ë–º–∫–∞ –æ–∫–æ–Ω—á–µ–Ω–∞** ‚Üí **–ù–∞ —Å–∫–ª–∞–¥–µ**

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
- –°—Ç–∞—Ç—É—Å—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –∏ –¥–∞—Ç –∑–∞—è–≤–æ–∫
- –î–∞—Ç—ã –≤—ã–¥–∞—á–∏ –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–∑ –±–ª–∏–∂–∞–π—à–∏—Ö –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫
- –ü–æ–ª–µ "–£ –∫–æ–≥–æ —Å–µ–π—á–∞—Å?" –∏–∑ –∑–∞—è–≤–æ–∫
- –ò—Å—Ç–æ—Ä–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

**–ú–µ—Ç–æ–¥—ã:**
- `update_equipment_statuses_by_date()` - –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤

### 3. EquipmentSheetsSync (–æ–±–Ω–æ–≤–ª—ë–Ω)

–û–±–Ω–æ–≤–ª—ë–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è —á–µ—Ä–µ–∑ `EquipmentCalendarSync`.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ú–µ—Ç–æ–¥ `_update_calendar()` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `EquipmentCalendarSync`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏/–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∑–∞—è–≤–æ–∫

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

```
–°—Ç—Ä–æ–∫–∞ 1: –ü–µ—Ä–∏–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–Ø–Ω–≤–∞—Ä—å 2025 - –ò—é–Ω—å 2025")
–°—Ç—Ä–æ–∫–∞ 2: –ß–∏—Å–ª–∞ –¥–Ω–µ–π (01, 02, 03, ...)
–°—Ç—Ä–æ–∫–∞ 3: –î–Ω–∏ –Ω–µ–¥–µ–ª–∏ (–ü–Ω, –í—Ç, –°—Ä, ...)
–°—Ç—Ä–æ–∫–∞ 4: –ü—É—Å—Ç–∞—è
–°—Ç—Ä–æ–∫–∏ 5+: –ù–æ–º–µ—Ä –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è | –î–∞—Ç–∞1 | –î–∞—Ç–∞2 | ...
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

```python
from app.services.equipment_calendar_sync import EquipmentCalendarSync
from app.services.google_service import GoogleService

google_service = GoogleService()
calendar_sync = EquipmentCalendarSync(google_service)

# –û–±–Ω–æ–≤–∏—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å
await calendar_sync.create_or_update_calendar_sheet(db)
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤

```python
from app.services.equipment_status_sync import EquipmentStatusSync

status_sync = EquipmentStatusSync(google_service)
result = await status_sync.update_equipment_statuses_by_date(db)
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ Google Sheets –≤ –ë–î:
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞—è–≤–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ –ë–î –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

### 2. –°–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –≤—ã–¥–∞—á–µ –∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è:
- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ –¥–µ–Ω—å –¥–æ –≤—ã–¥–∞—á–∏ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞–º)
- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ –¥–µ–Ω—å –¥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞–º)
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤)

### 3. –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–æ–≤:
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
- –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏:
- –°–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–∏
- –û–¥–æ–±—Ä–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏
- –ê–∫—Ç–∏–≤–∞—Ü–∏–∏ –∑–∞—è–≤–∫–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤

–°—Ç–∞—Ç—É—Å—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ:
```python
await status_sync.update_equipment_statuses_by_date(db)
```

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–∑—ã–≤–∞—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤) —á–µ—Ä–µ–∑ —Ñ–æ–Ω–æ–≤—É—é –∑–∞–¥–∞—á—É.

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Google API

–£—á—Ç–µ–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Google API:
- 60 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ 1 —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 5 —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –¥–ª—è —Ä–æ—Ç–∞—Ü–∏–∏
- Batch updates –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- –§–æ–Ω–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á
