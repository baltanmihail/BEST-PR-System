# –ü–ª–∞–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ Google Drive –∏ Sheets

## ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

1. **–ë–∞–∑–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Google Sheets:**
   - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã "BEST PR System - –¢–∞–π–º–ª–∞–π–Ω—ã"
   - –õ–∏—Å—Ç—ã: "–û–±—â–∏–π", "SMM", "Design", "Channel", "PR-FR"
   - –¶–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º –∑–∞–¥–∞—á
   - –ì–∏–ø–µ—Ä—Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–¥–∞—á
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ —Å –∏–∫–æ–Ω–∫–∞–º–∏ —Å—Ç–∞—Ç—É—Å–æ–≤

2. **–®–∞–±–ª–æ–Ω—ã –∑–∞–¥–∞—á:**
   - –ú–æ–¥–µ–ª—å TaskTemplate
   - API –¥–ª—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ –Ω–∞ Google Drive
   - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –∏–∑ —à–∞–±–ª–æ–Ω–æ–≤

3. **–¶–≤–µ—Ç–æ–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –¶–≤–µ—Ç–∞ –¥–ª—è —Ç–∏–ø–æ–≤ –∑–∞–¥–∞—á (SMM, Design, Channel, PR-FR)
   - –¶–≤–µ—Ç–∞ –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–¥–∞—á
   - –¶–≤–µ—Ç–∞ –¥–ª—è —ç—Ç–∞–ø–æ–≤ (–∏–∑ status_color)
   - –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –¥–µ–¥–ª–∞–π–Ω–æ–≤

## üöÄ –ß—Ç–æ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å

### 1. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –∑–∞–¥–∞—á (–í –ü–†–û–¶–ï–°–°–ï)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –§–∏–ª—å—Ç—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ API endpoint
- ‚úÖ –§–∏–ª—å—Ç—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∑–∞–ø—Ä–æ—Å –∑–∞–¥–∞—á
- ‚è≥ –ù—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –í sheets_sync.py —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ:
if statuses:
    status_enums = [TaskStatus(s) for s in statuses if s in [st.value for st in TaskStatus]]
    if status_enums:
        tasks_query = tasks_query.where(Task.status.in_(status_enums))
```

### 2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ Google Sheets –æ–±—Ä–∞—Ç–Ω–æ –≤ —Å–∏—Å—Ç–µ–º—É

**–ó–∞–¥–∞—á–∏:**
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–µ–¥–ª–∞–π–Ω–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–¥–∞—á
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —ç—Ç–∞–ø–æ–≤ (–¥–∞—Ç—ã, —Å—Ç–∞—Ç—É—Å—ã, —Ü–≤–µ—Ç–∞)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–ú–µ—Ç–æ–¥:**
- Polling –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Sheets —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ –ë–î
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –ø—Ä–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è—Ö

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
class SheetsSyncService:
    async def sync_sheets_changes_to_db(
        self,
        spreadsheet_id: str,
        db: AsyncSession
    ) -> dict:
        """–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ Sheets –≤ –ë–î"""
        # –ß–∏—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
        # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å –ë–î
        # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è—Ö
```

### 3. –£–ª—É—á—à–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç—Ç–∞–ø–∞–º–∏

**–ó–∞–¥–∞—á–∏:**
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —ç—Ç–∞–ø–æ–≤ —á–µ—Ä–µ–∑ API
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –∑–∞–¥–∞—á–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤ —ç—Ç–∞–ø–æ–≤
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ä–æ–∫–æ–≤ —ç—Ç–∞–ø–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Sheets

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ API –¥–ª—è —ç—Ç–∞–ø–æ–≤ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (`/api/v1/stages`)
- ‚è≥ –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —ç—Ç–∞–ø–æ–≤
- ‚è≥ –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç—Ç–∞–ø–∞–º–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

### 4. –°–∏—Å—Ç–µ–º–∞ —à–∞–±–ª–æ–Ω–æ–≤ –∑–∞–¥–∞—á

**–ó–∞–¥–∞—á–∏:**
- ‚úÖ –ú–æ–¥–µ–ª—å TaskTemplate —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ API –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤ —Å–æ–∑–¥–∞–Ω
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ Drive —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- ‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- ‚è≥ UI –¥–ª—è –≤—ã–±–æ—Ä–∞ —à–∞–±–ª–æ–Ω–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏

**–°–∏—Å—Ç–µ–º–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:**
1. **SMM - –ü–æ—Å—Ç –≤ —Å–æ—Ü—Å–µ—Ç–∏:**
   - –≠—Ç–∞–ø—ã: –ö–æ–Ω—Ü–µ–ø—Ç ‚Üí –¢–µ–∫—Å—Ç ‚Üí –î–∏–∑–∞–π–Ω ‚Üí –ü—É–±–ª–∏–∫–∞—Ü–∏—è
   - –¶–≤–µ—Ç–∞: green ‚Üí yellow ‚Üí blue ‚Üí green

2. **Design - –ì—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –ø–æ—Å—Ç–∞:**
   - –≠—Ç–∞–ø—ã: –ë—Ä–∏—Ñ ‚Üí –ö–æ–Ω—Ü–µ–ø—Ç ‚Üí –≠—Å–∫–∏–∑ ‚Üí –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è ‚Üí –ü—É–±–ª–∏–∫–∞—Ü–∏—è
   - –¶–≤–µ—Ç–∞: green ‚Üí yellow ‚Üí blue ‚Üí purple ‚Üí green

3. **Channel - –í–∏–¥–µ–æ—Ä–æ–ª–∏–∫:**
   - –≠—Ç–∞–ø—ã: –°—Ü–µ–Ω–∞—Ä–∏–π ‚Üí –°—ä—ë–º–∫–∞ ‚Üí –ú–æ–Ω—Ç–∞–∂ ‚Üí –û–∑–≤—É—á–∫–∞ ‚Üí –ü—É–±–ª–∏–∫–∞—Ü–∏—è
   - –¶–≤–µ—Ç–∞: green ‚Üí yellow ‚Üí blue ‚Üí purple ‚Üí green

4. **PR-FR - –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:**
   - –≠—Ç–∞–ø—ã: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ ‚Üí –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ ‚Üí –û—Ç—á—ë—Ç
   - –¶–≤–µ—Ç–∞: green ‚Üí yellow ‚Üí blue ‚Üí green

### 5. –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —ç—Ç–∞–ø–æ–≤

**–ó–∞–¥–∞—á–∏:**
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —ç—Ç–∞–ø–∞ –≤ Sheets ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —ç—Ç–∞–ø–∞ –≤ —Å–∏—Å—Ç–µ–º–µ ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Sheets
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å–∏—Å—Ç–µ–º—ã)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
async def sync_stage_changes_from_sheets(
    self,
    spreadsheet_id: str,
    sheet_name: str,
    db: AsyncSession
):
    """–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —ç—Ç–∞–ø–æ–≤ –∏–∑ Sheets"""
    # –ß–∏—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
    # –ù–∞—Ö–æ–¥–∏–º –∑–∞–¥–∞—á–∏ –ø–æ –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫–∞–º
    # –û–±–Ω–æ–≤–ª—è–µ–º —ç—Ç–∞–ø—ã –≤ –ë–î
```

### 6. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ–Ω–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

**–ó–∞–¥–∞—á–∏:**
- –§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ Drive ‚Üí –ë–î
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ Sheets ‚Üí –ë–î
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ –ë–î ‚Üí Sheets

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –í main.py –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ
async def background_sync_task():
    """–§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏"""
    while True:
        await asyncio.sleep(300)  # 5 –º–∏–Ω—É—Ç
        # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Drive ‚Üí –ë–î
        # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Sheets ‚Üí –ë–î
        # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ë–î ‚Üí Sheets
```

## üìã –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ):
1. ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –∑–∞–¥–∞—á
2. ‚è≥ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ Sheets –æ–±—Ä–∞—Ç–Ω–æ –≤ —Å–∏—Å—Ç–µ–º—É
3. ‚è≥ –£–ª—É—á—à–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç—Ç–∞–ø–∞–º–∏ (CRUD + —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ):
4. ‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ –∑–∞–¥–∞—á
5. ‚è≥ –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —ç—Ç–∞–ø–æ–≤
6. ‚è≥ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ–Ω–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ):
7. ‚è≥ UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç—Ç–∞–ø–∞–º–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
8. ‚è≥ UI –¥–ª—è –≤—ã–±–æ—Ä–∞ —à–∞–±–ª–æ–Ω–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏
9. ‚è≥ Webhooks –¥–ª—è Google Drive (–≤–º–µ—Å—Ç–æ polling)

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è API:
- 60 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç
- 5 –∞–∫–∫–∞—É–Ω—Ç–æ–≤ = 300 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω
- Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- Rate limiting –Ω–∞ –∫–∞–∂–¥—ã–π –∞–∫–∫–∞—É–Ω—Ç

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Sheets:
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ (–≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫–∞)
- –Ø—á–µ–π–∫–∏: –¥–∞—Ç–∞ ‚Üí —Å–æ–±—ã—Ç–∏—è (–¥–µ–¥–ª–∞–π–Ω—ã, —ç—Ç–∞–ø—ã)
- –¶–≤–µ—Ç–∞: —Ç–∏–ø –∑–∞–¥–∞—á–∏, —Å—Ç–∞—Ç—É—Å, —ç—Ç–∞–ø, –ø—Ä–æ—Å—Ä–æ—á–∫–∞

### –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ > –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Sheets
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞–º –æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö
