# Система шаблонов задач

## Обзор

Система шаблонов задач позволяет координаторам и VP4PR создавать готовые карточки задач с предустановленными этапами, ТЗ и другими параметрами. Шаблоны сохраняются на Google Drive и могут быть использованы для быстрого создания задач.

## Структура

### Категории шаблонов

- **coordinator_smm** - Шаблоны для координатора SMM
- **coordinator_design** - Шаблоны для координатора Design
- **coordinator_channel** - Шаблоны для координатора Channel
- **coordinator_prfr** - Шаблоны для координатора PR-FR
- **vp4pr** - Шаблоны для VP4PR
- **custom** - Пользовательские шаблоны

### Структура папок на Google Drive

```
BEST PR System/
└── Templates/
    ├── Coordinators/     # Шаблоны координаторов
    └── VP4PR/           # Шаблоны VP4PR
```

## Готовые шаблоны

### Для координатора SMM:
1. **Пост для соцсетей** - создание поста с этапами: написание текста, подбор визуала, согласование, публикация
2. **SMM-кампания** - комплексная кампания с этапами: стратегия, контент-план, материалы, запуск

### Для координатора Design:
1. **Дизайн поста** - создание дизайна с этапами: концепция, эскиз, финальный дизайн, экспорт
2. **Баннер для мероприятия** - создание баннера с этапами: бриф, концепция, дизайн, согласование

### Для координатора Channel:
1. **Видеоролик** - создание видео с этапами: сценарий, съёмка, монтаж, цветокоррекция, финальная версия
2. **Фотосессия** - проведение фотосессии с этапами: концепция, подготовка, съёмка, обработка

### Для координатора PR-FR:
1. **PR-активность** - организация активности с этапами: планирование, подготовка, проведение, отчёт

## API Endpoints

### Получить список шаблонов
```http
GET /api/v1/task-templates?category=coordinator_smm&task_type=smm&is_active=true
```

### Получить шаблон по ID
```http
GET /api/v1/task-templates/{template_id}
```

### Создать шаблон
```http
POST /api/v1/task-templates?category=coordinator_smm
Content-Type: application/json

{
  "name": "Новый шаблон",
  "description": "Описание шаблона",
  "task_type": "smm",
  "priority": "medium",
  "default_description": "Описание задачи по умолчанию",
  "equipment_available": false,
  "role_specific_requirements": {
    "smm": "ТЗ для SMM"
  },
  "questions": ["Вопрос 1", "Вопрос 2"],
  "stages_template": [
    {
      "stage_name": "Этап 1",
      "stage_order": 1,
      "due_date_offset": 7,
      "status_color": "green"
    }
  ]
}
```

### Обновить шаблон
```http
PATCH /api/v1/task-templates/{template_id}
Content-Type: application/json

{
  "name": "Обновлённое название",
  "stages_template": [...]
}
```

### Удалить шаблон
```http
DELETE /api/v1/task-templates/{template_id}
```

### Создать задачу из шаблона
```http
POST /api/v1/task-templates/{template_id}/create-task?title=Название задачи&due_date=2026-01-20T00:00:00Z
```

## Формат шаблона этапов

```json
{
  "stage_name": "Название этапа",
  "stage_order": 1,
  "due_date_offset": 7,
  "status_color": "green"
}
```

**Параметры:**
- `stage_name` - название этапа
- `stage_order` - порядок этапа (1, 2, 3...)
- `due_date_offset` - смещение дедлайна от дедлайна задачи (в днях). Например, 7 = за 7 дней до дедлайна задачи
- `status_color` - цвет этапа: `green`, `yellow`, `red`, `purple`, `blue`

## Использование

### Создание задачи из шаблона

1. Выберите шаблон из списка
2. Нажмите "Создать задачу из шаблона"
3. Укажите название задачи и дедлайн
4. Система автоматически создаст задачу со всеми этапами из шаблона

### Создание своего шаблона

1. Создайте задачу вручную с нужными этапами
2. Сохраните её как шаблон через API или интерфейс
3. Шаблон будет сохранён на Google Drive
4. Используйте шаблон для создания новых задач

## Создание готовых шаблонов

Для создания готовых системных шаблонов запустите скрипт:

```bash
python scripts/create_default_templates.py
```

Скрипт создаст все готовые шаблоны для каждого типа координатора.

## Синхронизация с Google Drive

- Шаблоны автоматически сохраняются на Google Drive в папке `Templates/`
- При изменении шаблона файл на Drive обновляется автоматически
- Файлы шаблонов хранятся в формате JSON

## Ограничения

- Системные шаблоны (созданные скриптом) нельзя удалить или изменить
- Только координаторы и VP4PR могут создавать и редактировать шаблоны
- Все пользователи могут просматривать шаблоны и создавать из них задачи
